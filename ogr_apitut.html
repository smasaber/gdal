<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>GDAL: OGR API Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="usergroup0.html"><span>Download</span></a></li>
      <li><a href="https://github.com/OSGeo/gdal/issues/"><span>Issue&#160;Tracker</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">OGR API Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document is intended to document using the OGR C++ classes to read and write data from a file. It is strongly advised that the read first review the <a href="ogr_arch.html">OGR Architecture</a> document describing the key classes and their roles in OGR.</p>
<p>It also includes code snippets for the corresponding functions in C and Python.</p>
<h1><a class="anchor" id="ogr_apitut_read"></a>
Reading From OGR</h1>
<p>For purposes of demonstrating reading with OGR, we will construct a small utility for dumping point layers from an OGR data source to stdout in comma-delimited format.</p>
<p>Initially it is necessary to register all the format drivers that are desired. This is normally accomplished by calling <a class="el" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26" title="Register all known configured GDAL drivers. ">GDALAllRegister()</a> which registers all format drivers built into GDAL/OGR.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="gdal_8h.html">gdal.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
</div><!-- fragment --><p>Next we need to open the input OGR datasource. Datasources can be files, RDBMSes, directories full of files, or even remote web services depending on the driver being used. However, the datasource name is always a single string. In this case we are hardcoded to open a particular shapefile. The second argument (GDAL_OF_VECTOR) tells the <a class="el" href="ogr__api_8h.html#a2da3630231780d519543d1679c83e62f" title="Open a file / data source with one of the registered drivers. ">OGROpen()</a> method that we want a vector driver to be use and that don't require update access. On failure NULL is returned, and we report an error.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classGDALDataset.html">GDALDataset</a>       *poDS;</div>
<div class="line"></div>
<div class="line">poDS = (<a class="code" href="classGDALDataset.html">GDALDataset</a>*) <a class="code" href="gdal_8h.html#aca05455472359964151f9c891d678d5e">GDALOpenEx</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, <a class="code" href="gdal_8h.html#a8253249767721c3e54a4a2844b30f256">GDAL_OF_VECTOR</a>, NULL, NULL, NULL );</div>
<div class="line"><span class="keywordflow">if</span>( poDS == NULL )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="gdal_8h.html#a2316f0c00f9997839f782ec946f8303d">GDALDatasetH</a> hDS;</div>
<div class="line"></div>
<div class="line">hDS = <a class="code" href="gdal_8h.html#aca05455472359964151f9c891d678d5e">GDALOpenEx</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, <a class="code" href="gdal_8h.html#a8253249767721c3e54a4a2844b30f256">GDAL_OF_VECTOR</a>, NULL, NULL, NULL );</div>
<div class="line"><span class="keywordflow">if</span>( hDS == NULL )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>A <a class="el" href="classGDALDataset.html" title="A set of associated raster bands, usually from one file. ">GDALDataset</a> can potentially have many layers associated with it. The number of layers available can be queried with <a class="el" href="classGDALDataset.html#a1cf5c6be551f8e16b0c0f677789b188d" title="Get the number of layers in this dataset. ">GDALDataset::GetLayerCount()</a> and individual layers fetched by index using <a class="el" href="classGDALDataset.html#a8e97c359216425a5d8fc4a8ef5b314d0" title="Fetch a layer by index. ">GDALDataset::GetLayer()</a>. However, we will just fetch the layer by name.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRLayer.html">OGRLayer</a>  *poLayer;</div>
<div class="line"></div>
<div class="line">poLayer = poDS-&gt;<a class="code" href="classGDALDataset.html#a576978fecfad68741b44719605cf637e">GetLayerByName</a>( <span class="stringliteral">&quot;point&quot;</span> );</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a635095fa23dfea934f4bb2df38fb9a67">OGRLayerH</a> hLayer;</div>
<div class="line"></div>
<div class="line">hLayer = <a class="code" href="gdal_8h.html#a06e1dfa7103356cbb11929a36c2ec139">GDALDatasetGetLayerByName</a>( hDS, <span class="stringliteral">&quot;point&quot;</span> );</div>
</div><!-- fragment --><p>Now we want to start reading features from the layer. Before we start we could assign an attribute or spatial filter to the layer to restrict the set of feature we get back, but for now we are interested in getting all features.</p>
<p>With GDAL 2.3 and C++11: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span>( <span class="keyword">auto</span>&amp; poFeature: poLayer )</div>
<div class="line">{</div>
</div><!-- fragment --><p>With GDAL 2.3 and C: </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a261ecc4eb3468bae5f5deaed761f4221">OGR_FOR_EACH_FEATURE_BEGIN</a>(hFeature, hLayer)</div>
<div class="line">{</div>
</div><!-- fragment --><p>If using older GDAL versions, while it isn't strictly necessary in this circumstance since we are starting fresh with the layer, it is often wise to call <a class="el" href="classOGRLayer.html#aad0f2cd7f0587584b8f382c6a913583c" title="Reset feature reading to start on the first feature. ">OGRLayer::ResetReading()</a> to ensure we are starting at the beginning of the layer. We iterate through all the features in the layer using <a class="el" href="classOGRLayer.html#a466c14ed1b3cca83abda52729d590dd2" title="Fetch the next available feature from this layer. ">OGRLayer::GetNextFeature()</a>. It will return NULL when we run out of features.</p>
<p>With GDAL &lt; 2.3 and C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;</div>
<div class="line"></div>
<div class="line">poLayer-&gt;ResetReading();</div>
<div class="line"><span class="keywordflow">while</span>( (poFeature = poLayer-&gt;GetNextFeature()) != NULL )</div>
<div class="line">{</div>
</div><!-- fragment --><p>With GDAL &lt; 2.3 and C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#aa4ebb4d695364da5635718ec664b95bf">OGRFeatureH</a> hFeature;</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#ab0383004bf637171648a9d03a80f15a4">OGR_L_ResetReading</a>(hLayer);</div>
<div class="line"><span class="keywordflow">while</span>( (hFeature = <a class="code" href="ogr__api_8h.html#a4f6ef6b70fee9f8cea92cb7a0236fcdb">OGR_L_GetNextFeature</a>(hLayer)) != NULL )</div>
<div class="line">{</div>
</div><!-- fragment --><p>In order to dump all the attribute fields of the feature, it is helpful to get the <a class="el" href="classOGRFeatureDefn.html" title="Definition of a feature class or feature layer. ">OGRFeatureDefn</a>. This is an object, associated with the layer, containing the definitions of all the fields. We loop over all the fields, and fetch and report the attributes based on their type.</p>
<p>With GDAL 2.3 and C++11: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span>( <span class="keyword">auto</span>&amp;&amp; oField: *poFeature )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span>( oField.GetType() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%d,&quot;</span>, oField.GetInteger() );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fcaec6a4e68818f1f377dfd6ae103f48f61">OFTInteger64</a>:</div>
<div class="line">            printf( <a class="code" href="cpl__port_8h.html#a68ee33a0dd985971eb7d559685890b1e">CPL_FRMT_GIB</a> <span class="stringliteral">&quot;,&quot;</span>, oField.GetInteger64() );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, oField.GetDouble() );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%s,&quot;</span>, oField.GetString() );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%s,&quot;</span>, oField.GetAsString() );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>With GDAL &lt; 2.3 and C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRFeatureDefn.html">OGRFeatureDefn</a> *poFDefn = poLayer-&gt;GetLayerDefn();</div>
<div class="line"><span class="keywordflow">for</span>( <span class="keywordtype">int</span> iField = 0; iField &lt; poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#a50e4cac3a74ef1591076155a19f47135">GetFieldCount</a>(); iField++ )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> *poFieldDefn = poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#a43b95ce699bbca73acb453cc959378e7">GetFieldDefn</a>( iField );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#a15cfed0653c42c768ae5a5a881dec5c9">GetType</a>() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%d,&quot;</span>, poFeature-&gt;GetFieldAsInteger( iField ) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fcaec6a4e68818f1f377dfd6ae103f48f61">OFTInteger64</a>:</div>
<div class="line">            printf( <a class="code" href="cpl__port_8h.html#a68ee33a0dd985971eb7d559685890b1e">CPL_FRMT_GIB</a> <span class="stringliteral">&quot;,&quot;</span>, poFeature-&gt;GetFieldAsInteger64( iField ) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, poFeature-&gt;GetFieldAsDouble(iField) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;GetFieldAsString(iField) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;GetFieldAsString(iField) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a827cc74dba4613e928843c4b5f781618">OGRFeatureDefnH</a> hFDefn = <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d">OGR_L_GetLayerDefn</a>(hLayer);</div>
<div class="line"><span class="keywordtype">int</span> iField;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span>( iField = 0; iField &lt; <a class="code" href="ogr__api_8h.html#a586a14271a457387a2b5c0097a02c8da">OGR_FD_GetFieldCount</a>(hFDefn); iField++ )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a624dc73953f25ea4efd8686d5121249b">OGRFieldDefnH</a> hFieldDefn = <a class="code" href="ogr__api_8h.html#a484456df86a01284769d0afe3beaa4f6">OGR_FD_GetFieldDefn</a>( hFDefn, iField );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611">OGR_Fld_GetType</a>(hFieldDefn) )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%d,&quot;</span>, <a class="code" href="ogr__api_8h.html#acfb4d2c0001af379e396021ecbdaf275">OGR_F_GetFieldAsInteger</a>( hFeature, iField ) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fcaec6a4e68818f1f377dfd6ae103f48f61">OFTInteger64</a>:</div>
<div class="line">            printf( <a class="code" href="cpl__port_8h.html#a68ee33a0dd985971eb7d559685890b1e">CPL_FRMT_GIB</a> <span class="stringliteral">&quot;,&quot;</span>, <a class="code" href="ogr__api_8h.html#a0e190099fd6ee40e206bf4bf74d3b784">OGR_F_GetFieldAsInteger64</a>( hFeature, iField ) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, <a class="code" href="ogr__api_8h.html#a62252a0d4538c695d41956a96cdc6978">OGR_F_GetFieldAsDouble</a>( hFeature, iField) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26">OGR_F_GetFieldAsString</a>( hFeature, iField) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26">OGR_F_GetFieldAsString</a>( hFeature, iField) );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>There are a few more field types than those explicitly handled above, but a reasonable representation of them can be fetched with the <a class="el" href="classOGRFeature.html#a880791a8413932b2d77d7b1bfcc34296" title="Fetch field value as a string. ">OGRFeature::GetFieldAsString()</a> method. In fact we could shorten the above by using <a class="el" href="classOGRFeature.html#a880791a8413932b2d77d7b1bfcc34296" title="Fetch field value as a string. ">OGRFeature::GetFieldAsString()</a> for all the types.</p>
<p>Next we want to extract the geometry from the feature, and write out the point geometry x and y. Geometries are returned as a generic <a class="el" href="classOGRGeometry.html" title="Abstract base class for all geometry classes. ">OGRGeometry</a> pointer. We then determine the specific geometry type, and if it is a point, we cast it to point and operate on it. If it is something else we write placeholders.</p>
<p>In C++ : </p><div class="fragment"><div class="line">    <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;</div>
<div class="line"></div>
<div class="line">    poGeometry = poFeature-&gt;GetGeometryRef();</div>
<div class="line">    <span class="keywordflow">if</span>( poGeometry != NULL</div>
<div class="line">            &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">#if GDAL_VERSION_NUM &gt;= GDAL_COMPUTE_VERSION(2,3,0)</span></div>
<div class="line">        <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = poGeometry-&gt;<a class="code" href="classOGRGeometry.html#acd2a41d2ee7091a39fc3f371db9e3825">toPoint</a>();</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">        <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = (<a class="code" href="classOGRPoint.html">OGRPoint</a> *) poGeometry;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">        printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9">getY</a>() );</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">    }</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a147386126eed05cc383cb3eb1b34104c">OGRGeometryH</a> hGeometry;</div>
<div class="line"></div>
<div class="line">hGeometry = <a class="code" href="ogr__api_8h.html#a1bf9596756aeacec4da502383c378f5c">OGR_F_GetGeometryRef</a>(hFeature);</div>
<div class="line"><span class="keywordflow">if</span>( hGeometry != NULL</div>
<div class="line">        &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(<a class="code" href="ogr__api_8h.html#a8fae58102f5c4a4cf2526e5ca8369a76">OGR_G_GetGeometryType</a>(hGeometry)) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, <a class="code" href="ogr__api_8h.html#a354146161d0a087b63ab6e350bae4d86">OGR_G_GetX</a>(hGeometry, 0), <a class="code" href="ogr__api_8h.html#a8405350c9aea2ab7d0f759f0b09b926f">OGR_G_GetY</a>(hGeometry, 0) );</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <a class="el" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823" title="Return the 2D geometry type corresponding to the specified geometry type. ">wkbFlatten()</a> macro is used above to convert the type for a wkbPoint25D (a point with a z coordinate) into the base 2D geometry type code (wkbPoint). For each 2D geometry type there is a corresponding 2.5D type code. The 2D and 2.5D geometry cases are handled by the same C++ class, so our code will handle 2D or 3D cases properly.</p>
<p>Starting with OGR 1.11, <a href="http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields">several geometry fields</a> can be associated to a feature.</p>
<p>In C++ : </p><div class="fragment"><div class="line">    <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;</div>
<div class="line">    <span class="keywordtype">int</span> iGeomField;</div>
<div class="line">    <span class="keywordtype">int</span> nGeomFieldCount;</div>
<div class="line"></div>
<div class="line">    nGeomFieldCount = poFeature-&gt;GetGeomFieldCount();</div>
<div class="line">    <span class="keywordflow">for</span>(iGeomField = 0; iGeomField &lt; nGeomFieldCount; iGeomField ++ )</div>
<div class="line">    {</div>
<div class="line">        poGeometry = poFeature-&gt;GetGeomFieldRef(iGeomField);</div>
<div class="line">        <span class="keywordflow">if</span>( poGeometry != NULL</div>
<div class="line">                &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">        {</div>
<div class="line"><span class="preprocessor">#if GDAL_VERSION_NUM &gt;= GDAL_COMPUTE_VERSION(2,3,0)</span></div>
<div class="line">            <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = poGeometry-&gt;<a class="code" href="classOGRGeometry.html#acd2a41d2ee7091a39fc3f371db9e3825">toPoint</a>();</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">            <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = (<a class="code" href="classOGRPoint.html">OGRPoint</a> *) poGeometry;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9">getY</a>() );</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a147386126eed05cc383cb3eb1b34104c">OGRGeometryH</a> hGeometry;</div>
<div class="line"><span class="keywordtype">int</span> iGeomField;</div>
<div class="line"><span class="keywordtype">int</span> nGeomFieldCount;</div>
<div class="line"></div>
<div class="line">nGeomFieldCount = <a class="code" href="ogr__api_8h.html#a7975076d4ab247189487c0fd50d8365c">OGR_F_GetGeomFieldCount</a>(hFeature);</div>
<div class="line"><span class="keywordflow">for</span>(iGeomField = 0; iGeomField &lt; nGeomFieldCount; iGeomField ++ )</div>
<div class="line">{</div>
<div class="line">    hGeometry = <a class="code" href="ogr__api_8h.html#a37aa8b53b1fc8816c5b7bcbbcb6a46ca">OGR_F_GetGeomFieldRef</a>(hFeature, iGeomField);</div>
<div class="line">    <span class="keywordflow">if</span>( hGeometry != NULL</div>
<div class="line">            &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(<a class="code" href="ogr__api_8h.html#a8fae58102f5c4a4cf2526e5ca8369a76">OGR_G_GetGeometryType</a>(hGeometry)) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, <a class="code" href="ogr__api_8h.html#a354146161d0a087b63ab6e350bae4d86">OGR_G_GetX</a>(hGeometry, 0),</div>
<div class="line">                <a class="code" href="ogr__api_8h.html#a8405350c9aea2ab7d0f759f0b09b926f">OGR_G_GetY</a>(hGeometry, 0) );</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>In Python: </p><div class="fragment"><div class="line">nGeomFieldCount = feat.GetGeomFieldCount()</div>
<div class="line"><span class="keywordflow">for</span> iGeomField in range(nGeomFieldCount):</div>
<div class="line">    geom = feat.GetGeomFieldRef(iGeomField)</div>
<div class="line">    if geom is not None and geom.GetGeometryType() == ogr.<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>:</div>
<div class="line">        print <span class="stringliteral">&quot;%.3f, %.3f&quot;</span> % ( geom.GetX(), geom.GetY() )</div>
<div class="line">    else:</div>
<div class="line">        print <span class="stringliteral">&quot;no point geometry\n&quot;</span></div>
</div><!-- fragment --><p>Note that <a class="el" href="classOGRFeature.html#acc966ce8c10ae3ddf9f14c2736fdce9a" title="Fetch pointer to feature geometry. ">OGRFeature::GetGeometryRef()</a> and <a class="el" href="classOGRFeature.html#ae54d999d4649730d5c7b37de731e4f69" title="Fetch pointer to feature geometry. ">OGRFeature::GetGeomFieldRef()</a> return a pointer to the internal geometry owned by the <a class="el" href="classOGRFeature.html" title="A simple feature, including geometry and attributes. ">OGRFeature</a>. There we don't actually deleted the return geometry.</p>
<p>With GDAL 2.3 and C++11, the looping over features is simply terminated by a closing curly bracket. </p><div class="fragment"><div class="line">}</div>
</div><!-- fragment --><p>With GDAL 2.3 and C, the looping over features is simply terminated by the following. </p><div class="fragment"><div class="line">}</div>
<div class="line"><a class="code" href="ogr__api_8h.html#a7c1c16c3af1f08084b3c261411beaf99">OGR_FOR_EACH_FEATURE_END</a>(hFeature)</div>
</div><!-- fragment --><p>For GDAL &lt; 2.3, as the <a class="el" href="classOGRLayer.html#a466c14ed1b3cca83abda52729d590dd2" title="Fetch the next available feature from this layer. ">OGRLayer::GetNextFeature()</a> method returns a copy of the feature that is now owned by us. So at the end of use we must free the feature. We could just "delete" it, but this can cause problems in windows builds where the GDAL DLL has a different "heap" from the main program. To be on the safe side we use a GDAL function to delete the feature.</p>
<p>In C++ : </p><div class="fragment"><div class="line">    <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45">OGRFeature::DestroyFeature</a>( poFeature );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line">    <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb">OGR_F_Destroy</a>( hFeature );</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <a class="el" href="classOGRLayer.html" title="This class represents a layer of simple features, with access methods. ">OGRLayer</a> returned by <a class="el" href="classGDALDataset.html#a576978fecfad68741b44719605cf637e" title="Fetch a layer by name. ">GDALDataset::GetLayerByName()</a> is also a reference to an internal layer owned by the <a class="el" href="classGDALDataset.html" title="A set of associated raster bands, usually from one file. ">GDALDataset</a> so we don't need to delete it. But we do need to delete the datasource in order to close the input file. Once again we do this with a custom delete method to avoid special win32 heap issues.</p>
<p>In C/C++ : </p><div class="fragment"><div class="line">    <a class="code" href="gdal_8h.html#a0984222d45a72028fcbbf1f44831ffbc">GDALClose</a>( poDS );</div>
<div class="line">}</div>
</div><!-- fragment --><p>All together our program looks like this.</p>
<p>With GDAL 2.3 and C++11 : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal__priv_8h.html#aca47b8ad96817baaace25ae9de63b2ab">GDALDatasetUniquePtr</a> poDS(<a class="code" href="classGDALDataset.html#a5379df6aeeebe76a985365acaeab756d">GDALDataset::Open</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, <a class="code" href="gdal_8h.html#a8253249767721c3e54a4a2844b30f256">GDAL_OF_VECTOR</a>));</div>
<div class="line">    <span class="keywordflow">if</span>( poDS == <span class="keyword">nullptr</span> )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classOGRLayer.html">OGRLayer</a>* poLayer: poDS-&gt;<a class="code" href="classGDALDataset.html#a8cfa4d17c68e441614118931b17cd7fa">GetLayers</a>() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; poFeature: *poLayer )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; oField: *poFeature )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">switch</span>( oField.GetType() )</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a>:</div>
<div class="line">                        printf( <span class="stringliteral">&quot;%d,&quot;</span>, oField.GetInteger() );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fcaec6a4e68818f1f377dfd6ae103f48f61">OFTInteger64</a>:</div>
<div class="line">                        printf( <a class="code" href="cpl__port_8h.html#a68ee33a0dd985971eb7d559685890b1e">CPL_FRMT_GIB</a> <span class="stringliteral">&quot;,&quot;</span>, oField.GetInteger64() );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a>:</div>
<div class="line">                        printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, oField.GetDouble() );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a>:</div>
<div class="line">                        printf( <span class="stringliteral">&quot;%s,&quot;</span>, oField.GetString() );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        printf( <span class="stringliteral">&quot;%s,&quot;</span>, oField.GetAsString() );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry = poFeature-&gt;GetGeometryRef();</div>
<div class="line">            <span class="keywordflow">if</span>( poGeometry != <span class="keyword">nullptr</span></div>
<div class="line">                    &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">            {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = poGeometry-&gt;<a class="code" href="classOGRGeometry.html#acd2a41d2ee7091a39fc3f371db9e3825">toPoint</a>();</div>
<div class="line"></div>
<div class="line">                printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9">getY</a>() );</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C++ : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classGDALDataset.html">GDALDataset</a> *poDS = <span class="keyword">static_cast&lt;</span><a class="code" href="classGDALDataset.html">GDALDataset</a>*<span class="keyword">&gt;</span>(</div>
<div class="line">        <a class="code" href="gdal_8h.html#aca05455472359964151f9c891d678d5e">GDALOpenEx</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, <a class="code" href="gdal_8h.html#a8253249767721c3e54a4a2844b30f256">GDAL_OF_VECTOR</a>, NULL, NULL, NULL ));</div>
<div class="line">    <span class="keywordflow">if</span>( poDS == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classOGRLayer.html">OGRLayer</a>  *poLayer = poDS-&gt;<a class="code" href="classGDALDataset.html#a576978fecfad68741b44719605cf637e">GetLayerByName</a>( <span class="stringliteral">&quot;point&quot;</span> );</div>
<div class="line">    <a class="code" href="classOGRFeatureDefn.html">OGRFeatureDefn</a> *poFDefn = poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf">GetLayerDefn</a>();</div>
<div class="line"></div>
<div class="line">    poLayer-&gt;<a class="code" href="classOGRLayer.html#aad0f2cd7f0587584b8f382c6a913583c">ResetReading</a>();</div>
<div class="line">    <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;</div>
<div class="line">    <span class="keywordflow">while</span>( (poFeature = poLayer-&gt;<a class="code" href="classOGRLayer.html#a466c14ed1b3cca83abda52729d590dd2">GetNextFeature</a>()) != NULL )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iField = 0; iField &lt; poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#a50e4cac3a74ef1591076155a19f47135">GetFieldCount</a>(); iField++ )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> *poFieldDefn = poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#a43b95ce699bbca73acb453cc959378e7">GetFieldDefn</a>( iField );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">switch</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#a15cfed0653c42c768ae5a5a881dec5c9">GetType</a>() )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%d,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#a415aff468393c13bbe8fee5d51ac227e">GetFieldAsInteger</a>( iField ) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fcaec6a4e68818f1f377dfd6ae103f48f61">OFTInteger64</a>:</div>
<div class="line">                    printf( <a class="code" href="cpl__port_8h.html#a68ee33a0dd985971eb7d559685890b1e">CPL_FRMT_GIB</a> <span class="stringliteral">&quot;,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ae877ca92c37b9f5bff7c059af1f8d7d4">GetFieldAsInteger64</a>( iField ) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#a6da3bfc77730b7b1162c83bcc0f73a2b">GetFieldAsDouble</a>(iField) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#a880791a8413932b2d77d7b1bfcc34296">GetFieldAsString</a>(iField) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#a880791a8413932b2d77d7b1bfcc34296">GetFieldAsString</a>(iField) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry = poFeature-&gt;<a class="code" href="classOGRFeature.html#acc966ce8c10ae3ddf9f14c2736fdce9a">GetGeometryRef</a>();</div>
<div class="line">        <span class="keywordflow">if</span>( poGeometry != NULL</div>
<div class="line">                &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = (<a class="code" href="classOGRPoint.html">OGRPoint</a> *) poGeometry;</div>
<div class="line"></div>
<div class="line">            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9">getY</a>() );</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45">OGRFeature::DestroyFeature</a>( poFeature );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a0984222d45a72028fcbbf1f44831ffbc">GDALClose</a>( poDS );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="gdal_8h.html">gdal.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a2316f0c00f9997839f782ec946f8303d">GDALDatasetH</a> hDS;</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a635095fa23dfea934f4bb2df38fb9a67">OGRLayerH</a> hLayer;</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#aa4ebb4d695364da5635718ec664b95bf">OGRFeatureH</a> hFeature;</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a827cc74dba4613e928843c4b5f781618">OGRFeatureDefnH</a> hFDefn;</div>
<div class="line"></div>
<div class="line">    hDS = <a class="code" href="gdal_8h.html#aca05455472359964151f9c891d678d5e">GDALOpenEx</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, <a class="code" href="gdal_8h.html#a8253249767721c3e54a4a2844b30f256">GDAL_OF_VECTOR</a>, NULL, NULL, NULL );</div>
<div class="line">    <span class="keywordflow">if</span>( hDS == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    hLayer = <a class="code" href="gdal_8h.html#a06e1dfa7103356cbb11929a36c2ec139">GDALDatasetGetLayerByName</a>( hDS, <span class="stringliteral">&quot;point&quot;</span> );</div>
<div class="line">    hFDefn = <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d">OGR_L_GetLayerDefn</a>(hLayer);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="ogr__api_8h.html#ab0383004bf637171648a9d03a80f15a4">OGR_L_ResetReading</a>(hLayer);</div>
<div class="line">    <span class="keywordflow">while</span>( (hFeature = <a class="code" href="ogr__api_8h.html#a4f6ef6b70fee9f8cea92cb7a0236fcdb">OGR_L_GetNextFeature</a>(hLayer)) != NULL )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> iField;</div>
<div class="line">        <a class="code" href="ogr__api_8h.html#a147386126eed05cc383cb3eb1b34104c">OGRGeometryH</a> hGeometry;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>( iField = 0; iField &lt; <a class="code" href="ogr__api_8h.html#a586a14271a457387a2b5c0097a02c8da">OGR_FD_GetFieldCount</a>(hFDefn); iField++ )</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="ogr__api_8h.html#a624dc73953f25ea4efd8686d5121249b">OGRFieldDefnH</a> hFieldDefn = <a class="code" href="ogr__api_8h.html#a484456df86a01284769d0afe3beaa4f6">OGR_FD_GetFieldDefn</a>( hFDefn, iField );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">switch</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611">OGR_Fld_GetType</a>(hFieldDefn) )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%d,&quot;</span>, <a class="code" href="ogr__api_8h.html#acfb4d2c0001af379e396021ecbdaf275">OGR_F_GetFieldAsInteger</a>( hFeature, iField ) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fcaec6a4e68818f1f377dfd6ae103f48f61">OFTInteger64</a>:</div>
<div class="line">                    printf( <a class="code" href="cpl__port_8h.html#a68ee33a0dd985971eb7d559685890b1e">CPL_FRMT_GIB</a> <span class="stringliteral">&quot;,&quot;</span>, <a class="code" href="ogr__api_8h.html#a0e190099fd6ee40e206bf4bf74d3b784">OGR_F_GetFieldAsInteger64</a>( hFeature, iField ) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, <a class="code" href="ogr__api_8h.html#a62252a0d4538c695d41956a96cdc6978">OGR_F_GetFieldAsDouble</a>( hFeature, iField) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26">OGR_F_GetFieldAsString</a>( hFeature, iField) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26">OGR_F_GetFieldAsString</a>( hFeature, iField) );</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        hGeometry = <a class="code" href="ogr__api_8h.html#a1bf9596756aeacec4da502383c378f5c">OGR_F_GetGeometryRef</a>(hFeature);</div>
<div class="line">        <span class="keywordflow">if</span>( hGeometry != NULL</div>
<div class="line">            &amp;&amp; <a class="code" href="ogr__core_8h.html#a5d2800b1a2d4f4dbcb906390969bb823">wkbFlatten</a>(<a class="code" href="ogr__api_8h.html#a8fae58102f5c4a4cf2526e5ca8369a76">OGR_G_GetGeometryType</a>(hGeometry)) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )</div>
<div class="line">        {</div>
<div class="line">            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, <a class="code" href="ogr__api_8h.html#a354146161d0a087b63ab6e350bae4d86">OGR_G_GetX</a>(hGeometry, 0), <a class="code" href="ogr__api_8h.html#a8405350c9aea2ab7d0f759f0b09b926f">OGR_G_GetY</a>(hGeometry, 0) );</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb">OGR_F_Destroy</a>( hFeature );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a0984222d45a72028fcbbf1f44831ffbc">GDALClose</a>( hDS );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In Python: </p><div class="fragment"><div class="line"><span class="keyword">import</span> sys</div>
<div class="line">from osgeo <span class="keyword">import</span> gdal</div>
<div class="line"></div>
<div class="line">ds = gdal.OpenEx( <span class="stringliteral">&quot;point.shp&quot;</span>, gdal.OF_VECTOR )</div>
<div class="line"><span class="keywordflow">if</span> ds is None:</div>
<div class="line">    print <span class="stringliteral">&quot;Open failed.\n&quot;</span></div>
<div class="line">    sys.exit( 1 )</div>
<div class="line"></div>
<div class="line">lyr = ds.GetLayerByName( <span class="stringliteral">&quot;point&quot;</span> )</div>
<div class="line"></div>
<div class="line">lyr.ResetReading()</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> feat in lyr:</div>
<div class="line"></div>
<div class="line">    feat_defn = lyr.GetLayerDefn()</div>
<div class="line">    <span class="keywordflow">for</span> i in range(feat_defn.GetFieldCount()):</div>
<div class="line">        field_defn = feat_defn.GetFieldDefn(i)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # Tests below can be simplified with just :</span></div>
<div class="line"><span class="preprocessor">        # print feat.GetField(i)</span></div>
<div class="line">        <span class="keywordflow">if</span> field_defn.GetType() == ogr.OFTInteger or field_defn.GetType() == ogr.OFTInteger64:</div>
<div class="line">            print <span class="stringliteral">&quot;%d&quot;</span> % feat.GetFieldAsInteger64(i)</div>
<div class="line">        elif field_defn.GetType() == ogr.OFTReal:</div>
<div class="line">            print <span class="stringliteral">&quot;%.3f&quot;</span> % feat.GetFieldAsDouble(i)</div>
<div class="line">        elif field_defn.GetType() == ogr.OFTString:</div>
<div class="line">            print <span class="stringliteral">&quot;%s&quot;</span> % feat.GetFieldAsString(i)</div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            print <span class="stringliteral">&quot;%s&quot;</span> % feat.GetFieldAsString(i)</div>
<div class="line"></div>
<div class="line">    geom = feat.GetGeometryRef()</div>
<div class="line">    <span class="keywordflow">if</span> geom is not None and geom.GetGeometryType() == ogr.wkbPoint:</div>
<div class="line">        print <span class="stringliteral">&quot;%.3f, %.3f&quot;</span> % ( geom.GetX(), geom.GetY() )</div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        print <span class="stringliteral">&quot;no point geometry\n&quot;</span></div>
<div class="line"></div>
<div class="line">ds = None</div>
</div><!-- fragment --><h1><a class="anchor" id="ogr_apitut_write"></a>
Writing To OGR</h1>
<p>As an example of writing through OGR, we will do roughly the opposite of the above. A short program that reads comma separated values from input text will be written to a point shapefile via OGR.</p>
<p>As usual, we start by registering all the drivers, and then fetch the Shapefile driver as we will need it to create our output file.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;</div>
<div class="line">    <a class="code" href="classGDALDriver.html">GDALDriver</a> *poDriver;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    poDriver = <a class="code" href="gdal__priv_8h.html#a4fb74d15f12b1ecd77bd8e5c48086590">GetGDALDriverManager</a>()-&gt;<a class="code" href="classGDALDriverManager.html#ac26308c182440c8abd584040fa89bd4f">GetDriverByName</a>(pszDriverName );</div>
<div class="line">    <span class="keywordflow">if</span>( poDriver == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ogr__api_8h.html">ogr_api.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;</div>
<div class="line">    <a class="code" href="classGDALDriver.html">GDALDriver</a> *poDriver;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    poDriver = (<a class="code" href="classGDALDriver.html">GDALDriver</a>*) <a class="code" href="gdal_8h.html#ae8ae868eef1e4773283d137b0a1adfc4">GDALGetDriverByName</a>(pszDriverName );</div>
<div class="line">    <span class="keywordflow">if</span>( poDriver == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
</div><!-- fragment --><p>Next we create the datasource. The ESRI Shapefile driver allows us to create a directory full of shapefiles, or a single shapefile as a datasource. In this case we will explicitly create a single file by including the extension in the name. Other drivers behave differently. The second, third, fourth and fifth argument are related to raster dimensions (in case the driver has raster capabilities). The last argument to the call is a list of option values, but we will just be using defaults in this case. Details of the options supported are also format specific.</p>
<p>In C ++ : </p><div class="fragment"><div class="line"><a class="code" href="classGDALDataset.html">GDALDataset</a> *poDS;</div>
<div class="line"></div>
<div class="line">poDS = poDriver-&gt;<a class="code" href="classGDALDriver.html#adb7bff9007fa5190d6cf742cf76942a8">Create</a>( <span class="stringliteral">&quot;point_out.shp&quot;</span>, 0, 0, 0, <a class="code" href="gdal_8h.html#a22e22ce0a55036a96f652765793fb7a4aee80d7a2ef95f128685e66f6e1024cbe">GDT_Unknown</a>, NULL );</div>
<div class="line"><span class="keywordflow">if</span>( poDS == NULL )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="gdal_8h.html#a2316f0c00f9997839f782ec946f8303d">GDALDatasetH</a> hDS;</div>
<div class="line"></div>
<div class="line">hDS = <a class="code" href="gdal_8h.html#a791083781fefae0bb4b289c4b1b838e9">GDALCreate</a>( hDriver, <span class="stringliteral">&quot;point_out.shp&quot;</span>, 0, 0, 0, <a class="code" href="gdal_8h.html#a22e22ce0a55036a96f652765793fb7a4aee80d7a2ef95f128685e66f6e1024cbe">GDT_Unknown</a>, NULL );</div>
<div class="line"><span class="keywordflow">if</span>( hDS == NULL )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now we create the output layer. In this case since the datasource is a single file, we can only have one layer. We pass wkbPoint to specify the type of geometry supported by this layer. In this case we aren't passing any coordinate system information or other special layer creation options.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRLayer.html">OGRLayer</a> *poLayer;</div>
<div class="line"></div>
<div class="line">poLayer = poDS-&gt;<a class="code" href="classGDALDataset.html#afec5fd0fffddbdf530cd6294caa66a7d">CreateLayer</a>( <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );</div>
<div class="line"><span class="keywordflow">if</span>( poLayer == NULL )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a635095fa23dfea934f4bb2df38fb9a67">OGRLayerH</a> hLayer;</div>
<div class="line"></div>
<div class="line">hLayer = <a class="code" href="gdal_8h.html#a7f01d3d8584f29e4ef3c56b5af49d816">GDALDatasetCreateLayer</a>( hDS, <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );</div>
<div class="line"><span class="keywordflow">if</span>( hLayer == NULL )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now that the layer exists, we need to create any attribute fields that should appear on the layer. Fields must be added to the layer before any features are written. To create a field we initialize an <a class="el" href="unionOGRField.html" title="OGRFeature field attribute value union. ">OGRField</a> object with the information about the field. In the case of Shapefiles, the field width and precision is significant in the creation of the output .dbf file, so we set it specifically, though generally the defaults are OK. For this example we will just have one attribute, a name string associated with the x,y point.</p>
<p>Note that the template <a class="el" href="unionOGRField.html" title="OGRFeature field attribute value union. ">OGRField</a> we pass to CreateField() is copied internally. We retain ownership of the object.</p>
<p>In C++: </p><div class="fragment"><div class="line"><a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> oField( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );</div>
<div class="line"></div>
<div class="line">oField.SetWidth(32);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a00b1376a1eabb1298ef278f92f6d84be">CreateField</a>( &amp;oField ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C: </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a624dc73953f25ea4efd8686d5121249b">OGRFieldDefnH</a> hFieldDefn;</div>
<div class="line"></div>
<div class="line">hFieldDefn = <a class="code" href="ogr__api_8h.html#a24af159359797a83c354fdf6cced3265">OGR_Fld_Create</a>( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#a1d7bf7c14a299448efac58f7bf364326">OGR_Fld_SetWidth</a>( hFieldDefn, 32);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#aab585ef1166c61c4819f7fd46ee4a275">OGR_L_CreateField</a>( hLayer, hFieldDefn, TRUE ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#a455fa4a2c2451b1748facb6b7126a822">OGR_Fld_Destroy</a>(hFieldDefn);</div>
</div><!-- fragment --><p>The following snipping loops reading lines of the form "x,y,name" from stdin, and parsing them.</p>
<p>In C++ and in C : </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> x, y;</div>
<div class="line"><span class="keywordtype">char</span> szName[33];</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">while</span>( !feof(stdin)</div>
<div class="line">       &amp;&amp; fscanf( stdin, <span class="stringliteral">&quot;%lf,%lf,%32s&quot;</span>, &amp;x, &amp;y, szName ) == 3 )</div>
<div class="line">{</div>
</div><!-- fragment --><p>To write a feature to disk, we must create a local <a class="el" href="classOGRFeature.html" title="A simple feature, including geometry and attributes. ">OGRFeature</a>, set attributes and attach geometry before trying to write it to the layer. It is imperative that this feature be instantiated from the <a class="el" href="classOGRFeatureDefn.html" title="Definition of a feature class or feature layer. ">OGRFeatureDefn</a> associated with the layer it will be written to.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;</div>
<div class="line"></div>
<div class="line">poFeature = <a class="code" href="classOGRFeature.html#a0ef4455f24cfbec6cf37110f9116cf15">OGRFeature::CreateFeature</a>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf">GetLayerDefn</a>() );</div>
<div class="line">poFeature-&gt;<a class="code" href="classOGRFeature.html#a4abbe118cc2f3e48bbac7f710b71b531">SetField</a>( <span class="stringliteral">&quot;Name&quot;</span>, szName );</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#aa4ebb4d695364da5635718ec664b95bf">OGRFeatureH</a> hFeature;</div>
<div class="line"></div>
<div class="line">hFeature = <a class="code" href="ogr__api_8h.html#a335fbf2220d7f93437621cae723558ac">OGR_F_Create</a>( <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d">OGR_L_GetLayerDefn</a>( hLayer ) );</div>
<div class="line"><a class="code" href="ogr__api_8h.html#ad1a3e8b4a08f9558807389bcdde85bab">OGR_F_SetFieldString</a>( hFeature, <a class="code" href="ogr__api_8h.html#a9a8a6b93ab97204b94f5c2b358f8f98e">OGR_F_GetFieldIndex</a>(hFeature, <span class="stringliteral">&quot;Name&quot;</span>), szName );</div>
</div><!-- fragment --><p>We create a local geometry object, and assign its copy (indirectly) to the feature. The <a class="el" href="classOGRFeature.html#a40a4ddb33f09a5f340b9139be72e277d" title="Set feature geometry. ">OGRFeature::SetGeometryDirectly()</a> differs from <a class="el" href="classOGRFeature.html#a67949569519c0de6ee3ea48f23ff11c9" title="Set feature geometry. ">OGRFeature::SetGeometry()</a> in that the direct method gives ownership of the geometry to the feature. This is generally more efficient as it avoids an extra deep object copy of the geometry.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRPoint.html">OGRPoint</a> pt;</div>
<div class="line">pt.<a class="code" href="classOGRPoint.html#a0eef5e2d9e0edeca0e0f06c7527facb4">setX</a>( x );</div>
<div class="line">pt.<a class="code" href="classOGRPoint.html#ab064eaaedb2140ed1410e7c2ce4ad1ca">setY</a>( y );</div>
<div class="line"></div>
<div class="line">poFeature-&gt;<a class="code" href="classOGRFeature.html#a67949569519c0de6ee3ea48f23ff11c9">SetGeometry</a>( &amp;pt );</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#a147386126eed05cc383cb3eb1b34104c">OGRGeometryH</a> hPt;</div>
<div class="line">hPt = <a class="code" href="ogr__api_8h.html#a60311342f2a329f433ea66e2d6fedadc">OGR_G_CreateGeometry</a>(<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>);</div>
<div class="line"><a class="code" href="ogr__api_8h.html#ab14b9730d6f9fc829fe6be9bc2a5ec48">OGR_G_SetPoint_2D</a>(hPt, 0, x, y);</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#a7b9c524f5c01a6a4b4e50e351d03299f">OGR_F_SetGeometry</a>( hFeature, hPt );</div>
<div class="line"><a class="code" href="ogr__api_8h.html#ac4e665f5f9690c4fa0c190b930fe9492">OGR_G_DestroyGeometry</a>(hPt);</div>
</div><!-- fragment --><p>Now we create a feature in the file. The <a class="el" href="classOGRLayer.html#a5d6db0be3b8876142d54e8bfd5dc8324" title="Create and write a new feature within a layer. ">OGRLayer::CreateFeature()</a> does not take ownership of our feature so we clean it up when done with it.</p>
<p>In C++ : </p><div class="fragment"><div class="line">     <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a5d6db0be3b8876142d54e8bfd5dc8324">CreateFeature</a>( poFeature ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">     {</div>
<div class="line">         printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">     }</div>
<div class="line"></div>
<div class="line">     <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45">OGRFeature::DestroyFeature</a>( poFeature );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line">     <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#a5009bc8d78d7f00e2745f3e3ad133779">OGR_L_CreateFeature</a>( hLayer, hFeature ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">     {</div>
<div class="line">         printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">     }</div>
<div class="line"></div>
<div class="line">     <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb">OGR_F_Destroy</a>( hFeature );</div>
<div class="line">}</div>
</div><!-- fragment --><p>Finally we need to close down the datasource in order to ensure headers are written out in an orderly way and all resources are recovered.</p>
<p>In C/C++ : </p><div class="fragment"><div class="line">    <a class="code" href="gdal_8h.html#a0984222d45a72028fcbbf1f44831ffbc">GDALClose</a>( poDS );</div>
<div class="line">}</div>
</div><!-- fragment --><p>The same program all in one block looks like this:</p>
<p>In C++ : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;</div>
<div class="line">    <a class="code" href="classGDALDriver.html">GDALDriver</a> *poDriver;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    poDriver = <a class="code" href="gdal__priv_8h.html#a4fb74d15f12b1ecd77bd8e5c48086590">GetGDALDriverManager</a>()-&gt;<a class="code" href="classGDALDriverManager.html#ac26308c182440c8abd584040fa89bd4f">GetDriverByName</a>(pszDriverName );</div>
<div class="line">    <span class="keywordflow">if</span>( poDriver == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classGDALDataset.html">GDALDataset</a> *poDS;</div>
<div class="line"></div>
<div class="line">    poDS = poDriver-&gt;<a class="code" href="classGDALDriver.html#adb7bff9007fa5190d6cf742cf76942a8">Create</a>( <span class="stringliteral">&quot;point_out.shp&quot;</span>, 0, 0, 0, <a class="code" href="gdal_8h.html#a22e22ce0a55036a96f652765793fb7a4aee80d7a2ef95f128685e66f6e1024cbe">GDT_Unknown</a>, NULL );</div>
<div class="line">    <span class="keywordflow">if</span>( poDS == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classOGRLayer.html">OGRLayer</a> *poLayer;</div>
<div class="line"></div>
<div class="line">    poLayer = poDS-&gt;<a class="code" href="classGDALDataset.html#afec5fd0fffddbdf530cd6294caa66a7d">CreateLayer</a>( <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );</div>
<div class="line">    <span class="keywordflow">if</span>( poLayer == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> oField( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );</div>
<div class="line"></div>
<div class="line">    oField.SetWidth(32);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a00b1376a1eabb1298ef278f92f6d84be">CreateField</a>( &amp;oField ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> x, y;</div>
<div class="line">    <span class="keywordtype">char</span> szName[33];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>( !feof(stdin)</div>
<div class="line">           &amp;&amp; fscanf( stdin, <span class="stringliteral">&quot;%lf,%lf,%32s&quot;</span>, &amp;x, &amp;y, szName ) == 3 )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;</div>
<div class="line"></div>
<div class="line">        poFeature = <a class="code" href="classOGRFeature.html#a0ef4455f24cfbec6cf37110f9116cf15">OGRFeature::CreateFeature</a>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf">GetLayerDefn</a>() );</div>
<div class="line">        poFeature-&gt;<a class="code" href="classOGRFeature.html#a4abbe118cc2f3e48bbac7f710b71b531">SetField</a>( <span class="stringliteral">&quot;Name&quot;</span>, szName );</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classOGRPoint.html">OGRPoint</a> pt;</div>
<div class="line"></div>
<div class="line">        pt.<a class="code" href="classOGRPoint.html#a0eef5e2d9e0edeca0e0f06c7527facb4">setX</a>( x );</div>
<div class="line">        pt.<a class="code" href="classOGRPoint.html#ab064eaaedb2140ed1410e7c2ce4ad1ca">setY</a>( y );</div>
<div class="line"></div>
<div class="line">        poFeature-&gt;<a class="code" href="classOGRFeature.html#a67949569519c0de6ee3ea48f23ff11c9">SetGeometry</a>( &amp;pt );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a5d6db0be3b8876142d54e8bfd5dc8324">CreateFeature</a>( poFeature ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">        {</div>
<div class="line">            printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );</div>
<div class="line">            exit( 1 );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45">OGRFeature::DestroyFeature</a>( poFeature );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a0984222d45a72028fcbbf1f44831ffbc">GDALClose</a>( poDS );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="gdal_8h.html">gdal.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;</div>
<div class="line">    <a class="code" href="gdal_8h.html#adfd09c07260442427a225e2a536ead72">GDALDriverH</a> hDriver;</div>
<div class="line">    <a class="code" href="gdal_8h.html#a2316f0c00f9997839f782ec946f8303d">GDALDatasetH</a> hDS;</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a635095fa23dfea934f4bb2df38fb9a67">OGRLayerH</a> hLayer;</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a624dc73953f25ea4efd8686d5121249b">OGRFieldDefnH</a> hFieldDefn;</div>
<div class="line">    <span class="keywordtype">double</span> x, y;</div>
<div class="line">    <span class="keywordtype">char</span> szName[33];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="gdal_8h.html#a9d40bc998bd6ed07ccde96028e85ae26">GDALAllRegister</a>();</div>
<div class="line"></div>
<div class="line">    hDriver = <a class="code" href="gdal_8h.html#ae8ae868eef1e4773283d137b0a1adfc4">GDALGetDriverByName</a>( pszDriverName );</div>
<div class="line">    <span class="keywordflow">if</span>( hDriver == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    hDS = <a class="code" href="gdal_8h.html#a791083781fefae0bb4b289c4b1b838e9">GDALCreate</a>( hDriver, <span class="stringliteral">&quot;point_out.shp&quot;</span>, 0, 0, 0, <a class="code" href="gdal_8h.html#a22e22ce0a55036a96f652765793fb7a4aee80d7a2ef95f128685e66f6e1024cbe">GDT_Unknown</a>, NULL );</div>
<div class="line">    <span class="keywordflow">if</span>( hDS == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    hLayer = <a class="code" href="gdal_8h.html#a7f01d3d8584f29e4ef3c56b5af49d816">GDALDatasetCreateLayer</a>( hDS, <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );</div>
<div class="line">    <span class="keywordflow">if</span>( hLayer == NULL )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    hFieldDefn = <a class="code" href="ogr__api_8h.html#a24af159359797a83c354fdf6cced3265">OGR_Fld_Create</a>( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );</div>
<div class="line"></div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a1d7bf7c14a299448efac58f7bf364326">OGR_Fld_SetWidth</a>( hFieldDefn, 32);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#aab585ef1166c61c4819f7fd46ee4a275">OGR_L_CreateField</a>( hLayer, hFieldDefn, TRUE ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">    {</div>
<div class="line">        printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );</div>
<div class="line">        exit( 1 );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a455fa4a2c2451b1748facb6b7126a822">OGR_Fld_Destroy</a>(hFieldDefn);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>( !feof(stdin)</div>
<div class="line">           &amp;&amp; fscanf( stdin, <span class="stringliteral">&quot;%lf,%lf,%32s&quot;</span>, &amp;x, &amp;y, szName ) == 3 )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="ogr__api_8h.html#aa4ebb4d695364da5635718ec664b95bf">OGRFeatureH</a> hFeature;</div>
<div class="line">        <a class="code" href="ogr__api_8h.html#a147386126eed05cc383cb3eb1b34104c">OGRGeometryH</a> hPt;</div>
<div class="line"></div>
<div class="line">        hFeature = <a class="code" href="ogr__api_8h.html#a335fbf2220d7f93437621cae723558ac">OGR_F_Create</a>( <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d">OGR_L_GetLayerDefn</a>( hLayer ) );</div>
<div class="line">        <a class="code" href="ogr__api_8h.html#ad1a3e8b4a08f9558807389bcdde85bab">OGR_F_SetFieldString</a>( hFeature, <a class="code" href="ogr__api_8h.html#a9a8a6b93ab97204b94f5c2b358f8f98e">OGR_F_GetFieldIndex</a>(hFeature, <span class="stringliteral">&quot;Name&quot;</span>), szName );</div>
<div class="line"></div>
<div class="line">        hPt = <a class="code" href="ogr__api_8h.html#a60311342f2a329f433ea66e2d6fedadc">OGR_G_CreateGeometry</a>(<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>);</div>
<div class="line">        <a class="code" href="ogr__api_8h.html#ab14b9730d6f9fc829fe6be9bc2a5ec48">OGR_G_SetPoint_2D</a>(hPt, 0, x, y);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ogr__api_8h.html#a7b9c524f5c01a6a4b4e50e351d03299f">OGR_F_SetGeometry</a>( hFeature, hPt );</div>
<div class="line">        <a class="code" href="ogr__api_8h.html#ac4e665f5f9690c4fa0c190b930fe9492">OGR_G_DestroyGeometry</a>(hPt);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#a5009bc8d78d7f00e2745f3e3ad133779">OGR_L_CreateFeature</a>( hLayer, hFeature ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">        {</div>
<div class="line">           printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );</div>
<div class="line">           exit( 1 );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb">OGR_F_Destroy</a>( hFeature );</div>
<div class="line">   }</div>
<div class="line"></div>
<div class="line">   <a class="code" href="gdal_8h.html#a0984222d45a72028fcbbf1f44831ffbc">GDALClose</a>( hDS );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In Python : </p><div class="fragment"><div class="line"><span class="keyword">import</span> sys</div>
<div class="line">from osgeo <span class="keyword">import</span> gdal</div>
<div class="line">from osgeo <span class="keyword">import</span> ogr</div>
<div class="line"><span class="keyword">import</span> <span class="keywordtype">string</span></div>
<div class="line"></div>
<div class="line">driverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span></div>
<div class="line">drv = gdal.GetDriverByName( driverName )</div>
<div class="line"><span class="keywordflow">if</span> drv is None:</div>
<div class="line">    print <span class="stringliteral">&quot;%s driver not available.\n&quot;</span> % driverName</div>
<div class="line">    sys.exit( 1 )</div>
<div class="line"></div>
<div class="line">ds = drv.Create( <span class="stringliteral">&quot;point_out.shp&quot;</span>, 0, 0, 0, gdal.GDT_Unknown )</div>
<div class="line"><span class="keywordflow">if</span> ds is None:</div>
<div class="line">    print <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span></div>
<div class="line">    sys.exit( 1 )</div>
<div class="line"></div>
<div class="line">lyr = ds.CreateLayer( <span class="stringliteral">&quot;point_out&quot;</span>, None, ogr.wkbPoint )</div>
<div class="line"><span class="keywordflow">if</span> lyr is None:</div>
<div class="line">    print <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span></div>
<div class="line">    sys.exit( 1 )</div>
<div class="line"></div>
<div class="line">field_defn = ogr.FieldDefn( <span class="stringliteral">&quot;Name&quot;</span>, ogr.OFTString )</div>
<div class="line">field_defn.SetWidth( 32 )</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> lyr.CreateField ( field_defn ) != 0:</div>
<div class="line">    print <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span></div>
<div class="line">    sys.exit( 1 )</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Expected format of user input: x y name</span></div>
<div class="line">linestring = raw_input()</div>
<div class="line">linelist = <span class="keywordtype">string</span>.split(linestring)</div>
<div class="line"></div>
<div class="line">while len(linelist) == 3:</div>
<div class="line">    x = <span class="keywordtype">float</span>(linelist[0])</div>
<div class="line">    y = <span class="keywordtype">float</span>(linelist[1])</div>
<div class="line">    name = linelist[2]</div>
<div class="line"></div>
<div class="line">    feat = ogr.Feature( lyr.GetLayerDefn())</div>
<div class="line">    feat.SetField( &quot;Name&quot;, name )</div>
<div class="line"></div>
<div class="line">    pt = ogr.Geometry(ogr.<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>)</div>
<div class="line">    pt.SetPoint_2D(0, x, y)</div>
<div class="line"></div>
<div class="line">    feat.SetGeometry(pt)</div>
<div class="line"></div>
<div class="line">    if lyr.CreateFeature(feat) != 0:</div>
<div class="line">        print &quot;Failed to create feature in shapefile.\n&quot;</div>
<div class="line">        sys.exit( 1 )</div>
<div class="line"></div>
<div class="line">    feat.Destroy()</div>
<div class="line"></div>
<div class="line">    linestring = raw_input()</div>
<div class="line">    linelist = <span class="keywordtype">string</span>.split(linestring)</div>
<div class="line"></div>
<div class="line">ds = None</div>
</div><!-- fragment --><p>Starting with OGR 1.11, <a href="http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields">several geometry fields</a> can be associated to a feature. This capability is just available for a few file formats, such as PostGIS.</p>
<p>To create such datasources, geometry fields must be first created. Spatial reference system objects can be associated to each geometry field.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRGeomFieldDefn.html">OGRGeomFieldDefn</a> oPointField( <span class="stringliteral">&quot;PointField&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );</div>
<div class="line"><a class="code" href="classOGRSpatialReference.html">OGRSpatialReference</a>* poSRS = <span class="keyword">new</span> <a class="code" href="classOGRSpatialReference.html">OGRSpatialReference</a>();</div>
<div class="line">poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#a8a5b8c9a205eedc6b88a14aa0c219969">importFromEPSG</a>(4326);</div>
<div class="line">oPointField.SetSpatialRef(poSRS);</div>
<div class="line">poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#aef9a8378c266604b9cd09042597a649f">Release</a>();</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#af3c68cad279ad80a476c6fb307cf5e48">CreateGeomField</a>( &amp;oPointField ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creating field PointField failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="classOGRGeomFieldDefn.html">OGRGeomFieldDefn</a> oFieldPoint2( <span class="stringliteral">&quot;PointField2&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );</div>
<div class="line">poSRS = <span class="keyword">new</span> <a class="code" href="classOGRSpatialReference.html">OGRSpatialReference</a>();</div>
<div class="line">poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#a8a5b8c9a205eedc6b88a14aa0c219969">importFromEPSG</a>(32631);</div>
<div class="line">oPointField2.SetSpatialRef(poSRS);</div>
<div class="line">poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#aef9a8378c266604b9cd09042597a649f">Release</a>();</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#af3c68cad279ad80a476c6fb307cf5e48">CreateGeomField</a>( &amp;oPointField2 ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creating field PointField2 failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#ab02dff2945904f6c0664e17a80c5f6bf">OGRGeomFieldDefnH</a> hPointField;</div>
<div class="line"><a class="code" href="ogr__api_8h.html#ab02dff2945904f6c0664e17a80c5f6bf">OGRGeomFieldDefnH</a> hPointField2;</div>
<div class="line"><a class="code" href="ogr__api_8h.html#a23361112dba57d043fa64632348c0870">OGRSpatialReferenceH</a> hSRS;</div>
<div class="line"></div>
<div class="line">hPointField = <a class="code" href="ogr__api_8h.html#a4681750642cae49933ba4fc962744b78">OGR_GFld_Create</a>( <span class="stringliteral">&quot;PointField&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );</div>
<div class="line">hSRS = <a class="code" href="ogr__srs__api_8h.html#a80d2790f618a9800a126e736afb1198e">OSRNewSpatialReference</a>( NULL );</div>
<div class="line"><a class="code" href="ogr__srs__api_8h.html#a02b89339400e5c5df84e535d54865ea0">OSRImportFromEPSG</a>(hSRS, 4326);</div>
<div class="line"><a class="code" href="ogr__api_8h.html#aa717acc8f4f5f33825334fe72edc2be9">OGR_GFld_SetSpatialRef</a>(hPointField, hSRS);</div>
<div class="line"><a class="code" href="ogr__srs__api_8h.html#adb5e564701dab4e83b3d353745f4a054">OSRRelease</a>(hSRS);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#af6908931c4f3ad364fef8d6e831363bc">OGR_L_CreateGeomField</a>( hLayer, hPointField ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creating field PointField failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#a0f3e65993ea2b8b907e43ffa8b106871">OGR_GFld_Destroy</a>( hPointField );</div>
<div class="line"></div>
<div class="line">hPointField2 = <a class="code" href="ogr__api_8h.html#a4681750642cae49933ba4fc962744b78">OGR_GFld_Create</a>( <span class="stringliteral">&quot;PointField2&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );</div>
<div class="line"><a class="code" href="ogr__srs__api_8h.html#a02b89339400e5c5df84e535d54865ea0">OSRImportFromEPSG</a>(hSRS, 32631);</div>
<div class="line"><a class="code" href="ogr__api_8h.html#aa717acc8f4f5f33825334fe72edc2be9">OGR_GFld_SetSpatialRef</a>(hPointField2, hSRS);</div>
<div class="line"><a class="code" href="ogr__srs__api_8h.html#adb5e564701dab4e83b3d353745f4a054">OSRRelease</a>(hSRS);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#af6908931c4f3ad364fef8d6e831363bc">OGR_L_CreateGeomField</a>( hLayer, hPointField2 ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Creating field PointField2 failed.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#a0f3e65993ea2b8b907e43ffa8b106871">OGR_GFld_Destroy</a>( hPointField2 );</div>
</div><!-- fragment --><p>To write a feature to disk, we must create a local <a class="el" href="classOGRFeature.html" title="A simple feature, including geometry and attributes. ">OGRFeature</a>, set attributes and attach geometries before trying to write it to the layer. It is imperative that this feature be instantiated from the <a class="el" href="classOGRFeatureDefn.html" title="Definition of a feature class or feature layer. ">OGRFeatureDefn</a> associated with the layer it will be written to.</p>
<p>In C++ : </p><div class="fragment"><div class="line"><a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;</div>
<div class="line"><a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;</div>
<div class="line"><span class="keywordtype">char</span>* pszWKT;</div>
<div class="line"></div>
<div class="line">poFeature = <a class="code" href="classOGRFeature.html#a0ef4455f24cfbec6cf37110f9116cf15">OGRFeature::CreateFeature</a>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf">GetLayerDefn</a>() );</div>
<div class="line"></div>
<div class="line">pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (2 49)&quot;</span>;</div>
<div class="line"><a class="code" href="classOGRGeometryFactory.html#a955f997c743af4220655285eda8724a9">OGRGeometryFactory::createFromWkt</a>( &amp;pszWKT, NULL, &amp;poGeometry );</div>
<div class="line">poFeature-&gt;<a class="code" href="classOGRFeature.html#ae0ddbbc910727ada3b2cd00a357222da">SetGeomFieldDirectly</a>( <span class="stringliteral">&quot;PointField&quot;</span>, poGeometry );</div>
<div class="line"></div>
<div class="line">pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (500000 4500000)&quot;</span>;</div>
<div class="line"><a class="code" href="classOGRGeometryFactory.html#a955f997c743af4220655285eda8724a9">OGRGeometryFactory::createFromWkt</a>( &amp;pszWKT, NULL, &amp;poGeometry );</div>
<div class="line">poFeature-&gt;<a class="code" href="classOGRFeature.html#ae0ddbbc910727ada3b2cd00a357222da">SetGeomFieldDirectly</a>( <span class="stringliteral">&quot;PointField2&quot;</span>, poGeometry );</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a5d6db0be3b8876142d54e8bfd5dc8324">CreateFeature</a>( poFeature ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Failed to create feature.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45">OGRFeature::DestroyFeature</a>( poFeature );</div>
</div><!-- fragment --><p>In C : </p><div class="fragment"><div class="line"><a class="code" href="ogr__api_8h.html#aa4ebb4d695364da5635718ec664b95bf">OGRFeatureH</a> hFeature;</div>
<div class="line"><a class="code" href="ogr__api_8h.html#a147386126eed05cc383cb3eb1b34104c">OGRGeometryH</a> hGeometry;</div>
<div class="line"><span class="keywordtype">char</span>* pszWKT;</div>
<div class="line"></div>
<div class="line">poFeature = <a class="code" href="ogr__api_8h.html#a335fbf2220d7f93437621cae723558ac">OGR_F_Create</a>( <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d">OGR_L_GetLayerDefn</a>(hLayer) );</div>
<div class="line"></div>
<div class="line">pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (2 49)&quot;</span>;</div>
<div class="line"><a class="code" href="ogr__api_8h.html#ac02c3ed5f7ebd5039dc2ae70154fd94a">OGR_G_CreateFromWkt</a>( &amp;pszWKT, NULL, &amp;hGeometry );</div>
<div class="line"><a class="code" href="ogr__api_8h.html#a01530e163973979cfd8248e3ecbf2640">OGR_F_SetGeomFieldDirectly</a>( hFeature,</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a546acd0aad47128b1f178a8d01765e63">OGR_F_GetGeomFieldIndex</a>(hFeature, <span class="stringliteral">&quot;PointField&quot;</span>), hGeometry );</div>
<div class="line"></div>
<div class="line">pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (500000 4500000)&quot;</span>;</div>
<div class="line"><a class="code" href="ogr__api_8h.html#ac02c3ed5f7ebd5039dc2ae70154fd94a">OGR_G_CreateFromWkt</a>( &amp;pszWKT, NULL, &amp;hGeometry );</div>
<div class="line"><a class="code" href="ogr__api_8h.html#a01530e163973979cfd8248e3ecbf2640">OGR_F_SetGeomFieldDirectly</a>( hFeature,</div>
<div class="line">    <a class="code" href="ogr__api_8h.html#a546acd0aad47128b1f178a8d01765e63">OGR_F_GetGeomFieldIndex</a>(hFeature, <span class="stringliteral">&quot;PointField2&quot;</span>), hGeometry );</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#a5009bc8d78d7f00e2745f3e3ad133779">OGR_L_CreateFeature</a>( hFeature ) != <a class="code" href="ogr__core_8h.html#a67a14d8dceb15392134cc51180c5e6f0">OGRERR_NONE</a> )</div>
<div class="line">{</div>
<div class="line">    printf( <span class="stringliteral">&quot;Failed to create feature.\n&quot;</span> );</div>
<div class="line">    exit( 1 );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb">OGR_F_Destroy</a>( hFeature );</div>
</div><!-- fragment --><p>In Python : </p><div class="fragment"><div class="line">feat = ogr.Feature( lyr.GetLayerDefn() )</div>
<div class="line"></div>
<div class="line">feat.SetGeomFieldDirectly( <span class="stringliteral">&quot;PointField&quot;</span>,</div>
<div class="line">    ogr.CreateGeometryFromWkt( <span class="stringliteral">&quot;POINT (2 49)&quot;</span> ) )</div>
<div class="line">feat.SetGeomFieldDirectly( <span class="stringliteral">&quot;PointField2&quot;</span>,</div>
<div class="line">    ogr.CreateGeometryFromWkt( <span class="stringliteral">&quot;POINT (500000 4500000)&quot;</span> ) )</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> lyr.CreateFeature( feat ) != 0 )</div>
<div class="line">{</div>
<div class="line">    print( <span class="stringliteral">&quot;Failed to create feature.\n&quot;</span> );</div>
<div class="line">    sys.exit( 1 );</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<hr>
Generated for GDAL by
<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.8.
</body>
</html>
